<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Mojang Maps - Web UI</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="styles.css">
    </head>
    <body>
        <noscript>JavaScript is required to view this Web UI</noscript>
        <canvas id="canvas" width="500" height="500">
            Your browser does not support canvas
        </canvas>
        <button id="resetButton">Reset</button>

        <script>
        var canvas = document.getElementById('canvas');
        var context = canvas.getContext('2d');
        var isDragging = false;
        var startOffsetX, startOffsetY;
        var zoomLevel = 1;

        // Array of nodes (points) with road names
        var nodes = [
            { x: 50, y: 50, roadName: "Road 1" },
            { x: 150, y: 100, roadName: "Road 2" },
            { x: 250, y: 50, roadName: "Road 3" },
            { x: 350, y: 100, roadName: "Road 4" },
            { x: 450, y: 50, roadName: "Road 5" }
        ];

        function drawLines() {
            context.fillStyle = '#f8f7f7';
            context.fillRect(0, 0, canvas.width, canvas.height);
            context.save();

            // Apply zoom
            context.scale(zoomLevel, zoomLevel);

            // Draw lines
            context.beginPath();
            context.moveTo(nodes[0].x, nodes[0].y);

            for (var i = 1; i < nodes.length; i++) {
                context.lineTo(nodes[i].x, nodes[i].y);
            }

            context.strokeStyle = '#8ba5c1';
            context.lineWidth = 7;
            context.stroke();

            context.restore();
        }

        function drawRoadNames() {
            // Draw road names
            for (var i = 1; i < nodes.length; i++) {
                // Calculate midpoint
                var midX = (nodes[i].x + nodes[i - 1].x) / 2;
                var midY = (nodes[i].y + nodes[i - 1].y) / 2;

                // Adjust midpoint based on zoom level
                midX *= zoomLevel;
                midY *= zoomLevel;

                // Move the road names slightly down
                var offsetY = 10;

                // Calculate font size based on zoom level, with a minimum size of 14px when fully zoomed out
                var fontSize = 14 * zoomLevel;

                // Ensure font size stays within reasonable limits
                fontSize = Math.max(14, Math.min(24, fontSize));

                // Render road names at the adjusted midpoint directly on top of the road
                context.font = fontSize + 'px Arial';
                context.fillStyle = '#000';
                context.textAlign = 'center';
                context.textBaseline = 'bottom'; // Adjust the baseline to place the text on top
                context.save();
                context.translate(midX, midY + offsetY);
                var angle = Math.atan2(nodes[i].y - nodes[i - 1].y, nodes[i].x - nodes[i - 1].x);
                context.rotate(angle);
                context.fillText(nodes[i].roadName, 0, 0);
                context.restore();
            }
        }

        function handleMouseDown(event) {
            isDragging = true;
            startOffsetX = event.clientX - canvas.offsetLeft;
            startOffsetY = event.clientY - canvas.offsetTop;
            canvas.style.cursor = 'grabbing';
        }

        function handleMouseMove(event) {
            if (!isDragging) return;

            var offsetX = event.clientX - canvas.offsetLeft;
            var offsetY = event.clientY - canvas.offsetTop;
            var dx = offsetX - startOffsetX;
            var dy = offsetY - startOffsetY;

            nodes.forEach(function(node) {
                node.x += dx / zoomLevel;
                node.y += dy / zoomLevel;
            });

            startOffsetX = offsetX;
            startOffsetY = offsetY;

            drawLines();
            drawRoadNames(); // Draw road names after lines to ensure they are on top
        }

        function handleMouseUp() {
            isDragging = false;
            canvas.style.cursor = 'grab';
        }

        function handleWheel(event) {
            // Adjust zoom level based on wheel direction
            zoomLevel += event.deltaY * -0.01;

            // Clamp zoom level to prevent too small or too large zoom
            zoomLevel = Math.max(0.1, Math.min(3, zoomLevel));

            drawLines();
            drawRoadNames(); // Draw road names after lines to ensure they are on top
            event.preventDefault(); // Prevent the default scroll behavior
        }

        function handleResize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            drawLines();
            drawRoadNames(); // Draw road names after lines to ensure they are on top
        }

        function handleReset() {
            // Reset zoom level and nodes
            zoomLevel = 1;
            nodes = [
                { x: 50, y: 50, roadName: "Road 1" },
                { x: 150, y: 100, roadName: "Road 2" },
                { x: 250, y: 50, roadName: "Road 3" },
                { x: 350, y: 100, roadName: "Road 4" },
                { x: 450, y: 50, roadName: "Road 5" }
            ];

            drawLines();
            drawRoadNames(); // Draw road names after lines to ensure they are on top
        }

        // Initial draw, sizing, and event listeners
        handleReset();
        handleResize();
        window.addEventListener('resize', handleResize);
        canvas.addEventListener('mousedown', handleMouseDown);
        canvas.addEventListener('mousemove', handleMouseMove);
        canvas.addEventListener('mouseup', handleMouseUp);
        canvas.addEventListener('mouseleave', handleMouseUp);
        canvas.addEventListener('wheel', handleWheel);

        // Add event listener for the reset button
        document.getElementById('resetButton').addEventListener('click', handleReset);
        </script>
    </body>
</html>